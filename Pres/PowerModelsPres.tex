\documentclass[xcolor=dvipsnames]{beamer}
\usepackage{etex}
%\usetheme[background=light]{metropolis}           % Use metropolis theme

\usepackage{algorithm, algorithmicx}
\usepackage{algpseudocode} %can use [noned] for a python-like pseudo-code.
\usepackage{amsmath,amssymb}
\usepackage{amsfonts}
%\usepackage{graphics,graphicx}
\usepackage{booktabs}	 
\usepackage{multirow}
\usepackage{float}
\usepackage{caption, subcaption}
\usepackage{lineno}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{comment}
%\usepackage{pgfplots,pgfplotstable}

\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}

\newcommand{\braces}[1]{\left\{ #1 \right \}}
\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\norm}[1]{\left \| #1 \right \|}
\newcommand{\conv}{\text{conv}}

\newcommand{\LFlows}{\mathcal{F}}
\newcommand{\auxSlk}{a}
\newcommand{\sg}{\sigma}
\newcommand{\cc}{\alpha}
\newcommand{\CCC}{A}
\newcommand{\vv}{v}
\newcommand{\vR}{\vv^{R}}
\newcommand{\vI}{\vv^{I}}
%\newcommand{\vv0}{\overline{v}}
\newcommand{\vvv}{\overline{v}}
\newcommand{\vmin}{v^{min}}
\newcommand{\vmax}{v^{max}}
\newcommand{\p}[1]{p^{#1}}
\newcommand{\pbus}{p^N}
\newcommand{\qbus}{q^N}
\newcommand{\pbusH}{p^H}
\newcommand{\qbusH}{q^H}
%\newcommand{\p0}{\overline{p}}
\newcommand{\ppp}{\overline{p}}
\newcommand{\q}[1]{q^{#1}}
\newcommand{\qqq}{\overline{q}}
\newcommand{\s}{s}
\newcommand{\ii}{i}
\newcommand{\jj}{j}
\newcommand{\llll}{l}
\newcommand{\from}{f}
\newcommand{\tto}{t}
\newcommand{\g}{g}
\newcommand{\Y}{Y}
\newcommand{\B}{B}
\newcommand{\x}{x}
\newcommand{\I}{I}
\newcommand{\G}{G}

\newcommand{\YffR}{Y^{ffR}}
\newcommand{\YftR}{Y^{ftR}}
\newcommand{\YtfR}{Y^{tfR}}
\newcommand{\YttR}{Y^{ttR}}
\newcommand{\YffI}{Y^{ffI}}
\newcommand{\YftI}{Y^{ftI}}
\newcommand{\YtfI}{Y^{tfI}}
\newcommand{\YttI}{Y^{ttI}}
\newcommand{\YshR}{Y^{shR}}
\newcommand{\YshI}{Y^{shI}}
\newcommand{\WW}{W}
\newcommand{\W}{w}
\newcommand{\Wff}{{\W}^{ff}}
\newcommand{\Wtt}{{\W}^{tt}}
\newcommand{\WftR}{{\W}^{ftR}}
\newcommand{\WftI}{{\W}^{ftI}}
\newcommand{\WtfR}{{\W}^{tfR}}
\newcommand{\WtfI}{{\W}^{tfI}}
\newcommand{\Lines}{L}

\newcommand{\red}[1]{\textcolor{BrickRed}{#1}}
\newcommand{\blue}[1]{\textcolor{Cyan}{#1}}

\title{Applying proximal bundle method approaches to the dual SDP reformulation of ACOPF}
\date{}
\author{Brian Dandurand \\
joint work with: \\
Kibaek Kim \\
Sang-il Yim
}
\institute{Division of Mathematics and Computer Science \\ Argonne National Laboratory, USA}

%\titlegraphic{\hfill\includegraphics[height=2.5cm]{rmitlogo.png}}

\setbeamercolor{progress bar}{fg=BlueGreen}
\setbeamercolor{alerted text}{fg=BlueGreen}

\setbeamertemplate{frame footer}{bdandurand@anl.gov $\|\|$ 16 Aug 2019} 

\setbeamertemplate{title graphic}{
  \vbox to 0pt {
    \vspace*{.55\textheight}  % change the value as necessary
    \inserttitlegraphic%
  }%
  \nointerlineskip%
}



\begin{document}
  \maketitle

\begin{frame}{Power System Model}
Balance between generation and demand must be maintained over an AC power network under physical constraints on the power generation, and voltage magnitude.
Buses are indexed by $i \in N$ and lines (including transformers) are indexed by $l \in L$.
\begin{footnotesize}
\begin{subequations}
\label{EqDSP}
\begin{align}
  & W = v v^* \label{rank1}\\
  & P_i^{min} \leq p_i^G \leq P_i^{max}, \quad Q_i^{min} \leq q_i^G \leq Q_i^{max}, \quad i\in N \label{PGBds} \\
  & p_i^{sh}(\WW_{ii}) 
+ \sum_{\llll \in \Lines_\ii^{\from} } \p{\from}_{\llll}(\WW_\llll)  
	+\sum_{\llll \in \Lines_\ii^{\tto} } \p{\tto}_{\llll}(\WW_\llll) - p^G_i + P^D_i = 0, \quad i\in N, \label{PFlowEq}\\ 
  & q_\ii^{sh}(\WW_{\ii\ii}) + \sum_{\llll \in \Lines_\ii^{\from} } \q{\from}_{\llll}(\WW_\llll) 
	+\sum_{\llll \in \Lines_\ii^{\tto} } \q{\tto}_{\llll}(\WW_\llll) - q^G_i + Q^D_i = 0, \quad i\in N, \label{QFlowEq} \\
  & (V_i^{min})^2 \leq W_{ii} \leq (V_i^{max})^2,\quad i\in N, \label{VMagBds} 
\end{align}
\end{subequations}
\end{footnotesize}
where $v,W,p^G,q^G,u$ are decision variables. 
\end{frame}

\begin{frame}{Power System Model: Feasibility Problem}
\begin{footnotesize}
Balance between generation and demand must be maintained over an AC power network under physical constraints on the power generation, and voltage magnitude.
Buses are indexed by $i \in N$ and lines (including transformers) are indexed by $l \in L$.
\begin{subequations}
\begin{align}
&\min_{\substack{v,W,p^G,q^G,\\ p^f,p^t,q^f,q^t,\\ u \geqq 0}} \quad 
  \sum_{i \in N} u_i^p + u_i^q  \notag \\
  & W = v v^* \notag\\
  & P_i^{min} \leq p_i^G \leq P_i^{max}, \quad Q_i^{min} \leq q_i^G \leq Q_i^{max}, \quad i\in N \notag \\
  & (V_i^{min})^2 \leq W_{ii} \leq (V_i^{max})^2,\quad i\in N, \notag \\
  & -u_i^p \le p_i^{sh}(\WW_{ii}) - p^G_i + P^D_i 
	+ \sum_{\llll \in \Lines_\ii^{\from} } \p{\from}_{\llll}(\WW_\llll)  
	+\sum_{\llll \in \Lines_\ii^{\tto}   } \p{\tto}_{\llll}(\WW_\llll)
	\le u_i^p \quad i\in N, \notag\\ 
  & -u_i^q \le q_i^{sh}(\WW_{ii}) - q^G_i + Q^D_i 
	+ \sum_{\llll \in \Lines_\ii^{\from}} \q{\from}_{\llll}(\WW_\llll)
	+ \sum_{\llll \in \Lines_\ii^{\tto} } \q{\tto}_{\llll}(\WW_\llll)
	\le u_i^q \quad i\in N. \notag
\end{align}
\end{subequations}
where $v,W,p^G,q^G,u$ are decision variables. 
\end{footnotesize}
%&  (p_{l}^{f,0,-} + p_{l}^{f,0,+}) + (p_{l}^{t,0,-} + p_{l}^{t,0,+}) + (q_{l}^{f,0,-} + q_{l}^{f,0,+}) + (q_{l}^{t,0,-} + q_{l}^{t,0,+})  \notag \\
%& =  (p_{l}^{f,1,-} + p_{l}^{f,1,+}) + (p_{l}^{t,1,-} + p_{l}^{t,1,+}) + (q_{l}^{f,1,-} + q_{l}^{f,1,+}) + (q_{l}^{t,1,-} + q_{l}^{t,1,+}) + u^K, \quad \llll \in L. \notag
\end{frame}

\begin{frame}{Definitions}
$L$ is the set of lines (including transformers)
\begin{enumerate}
\item $L^0 \subseteq L$ is the set of lines that are fixed as on; an attacker is committed to \emph{not} attacking line $l \in L^0$
\item $L^1 \subseteq L$ is the set of lines that are fixed as off; an attacker is committed to attacking $l \in L^1$
\item $L^* = L \backslash (L^0 \cup L^1)$ are the remaining ``undecided" lines that the attacker needs to decide whether or not to attack.
\end{enumerate}
$\{ L^0, L^1, L^*\}$ is a partition of the set $L$.
\end{frame}

\begin{frame}{Power System Model: Feasibility Problem with robustness parameterized by attack budget $K$}
\begin{footnotesize}
\begin{subequations}
\begin{align}
&\min_{\substack{p,q\\ u \geqq 0,W=vv^*}} \quad 
  (K-|L^1|) u^K + \sum_{i \in N} u_i^p + u_i^q + \sum_{l \in L^*} u_l^{pf1} + u_l^{ft1} + u_l^{qf1} + u_l^{qt1}  \notag \\
  & P_i^{min} \leq p_i^G \leq P_i^{max}, \quad Q_i^{min} \leq q_i^G \leq Q_i^{max}, \quad (V_i^{min})^2 \leq W_{ii} \leq (V_i^{max})^2,\quad i\in N \notag \\
  & -u_i^p \le p_i^{sh}(\WW_{ii}) - p^G_i + P^D_i 
	+ \sum_{\llll \in \Lines_\ii^{\from} \cap (L^* \cup L^0)  } p_{l}^{f}  
	+\sum_{\llll \in \Lines_\ii^{\tto} \cap (L^* \cup L^0) } p_{l}^{t} 
	\le u_i^p \quad i\in N, \notag\\ 
  & -u_i^q \le q_i^{sh}(\WW_{ii}) - q^G_i + Q^D_i 
	+ \sum_{\llll \in \Lines_\ii^{\from} \cap (L^* \cup L^0) } q_{l}^{f}
	+ \sum_{\llll \in \Lines_\ii^{\tto} \cap (L^* \cup L^0) } q_{l}^{t} 
	\le u_i^q \quad i\in N, \notag \\
& p_{l}^{f}=\p{\from}_{\llll}(\WW_\llll),\quad p_l^t=\p{\tto}_{\llll}(\WW_\llll),\quad q_l^f=\q{\from}_{\llll}(\WW_\llll),\quad q_l^t=\q{\tto}_{\llll}(\WW_\llll) , \quad \llll \in L^0 \notag \\
& -u_l^{pf1} \le \p{\from}_{\llll}(\WW_\llll) - p_{l}^{f} \le u_l^{pf1}, \quad
 -u_l^{pt1} \le \p{\tto}_{\llll}(\WW_\llll)  - p_{l}^{t} \le u_l^{pt1}, \quad \llll \in L^* \notag \\
& -u_l^{qf1} \le \q{\from}_{\llll}(\WW_\llll) - q_{l}^{f} \le u_l^{qf1}, \quad 
 -u_l^{qt1} \le \q{\tto}_{\llll}(\WW_\llll)  - q_{l}^{t} \le u_l^{qt1}, \quad \llll \in L^* \notag \\
& -u_l^{pf0} \le p_l^f \le u_l^{pf0},\quad-u_l^{pt0} \le p_l^t \le u_l^{pt0}, \quad l \in L^* \notag\\ 
& -u_l^{qf0} \le q_l^f \le u_l^{qf0},\quad-u_l^{qt0} \le q_l^t \le u_l^{qt0}, \quad l \in L^* \notag \\
& u_l^{pf0} + u_l^{pt0} + u_l^{qf0} + u_l^{qt0} = u_l^{pf1} + u_l^{pt1} + u_l^{qf1} + u_l^{qt1} + u^K,\quad l \in L^* \notag
\end{align}
\end{subequations}
\end{footnotesize}
%&  (p_{l}^{f,0,-} + p_{l}^{f,0,+}) + (p_{l}^{t,0,-} + p_{l}^{t,0,+}) + (q_{l}^{f,0,-} + q_{l}^{f,0,+}) + (q_{l}^{t,0,-} + q_{l}^{t,0,+})  \notag \\
%& =  (p_{l}^{f,1,-} + p_{l}^{f,1,+}) + (p_{l}^{t,1,-} + p_{l}^{t,1,+}) + (q_{l}^{f,1,-} + q_{l}^{f,1,+}) + (q_{l}^{t,1,-} + q_{l}^{t,1,+}) + u^K, \quad \llll \in L. \notag
\end{frame}


\begin{frame}{Double-checking dual equivalence: Forming the Lagrangian}
\begin{tiny}
\begin{subequations}
\begin{align}
&\min_{\substack{p,q\\ u \geqq 0,W=vv^*}} \quad 
  \sum_{i \in N} u_i^{p}(1-|\alpha_{\ii}|) +  u_i^{q}(1-|\beta_{\ii}|)   
+ u^K(K-|L^1|-\sum_{l \in L^*} x_l) \notag \\
  &+\sum_{\ii \in N} W_\ii(\gamma_{\ii}^+-\gamma_{\ii}^-) +p_\ii^{sh}(\WW_{ii})\alpha_\ii + q_\ii^{sh}(\WW_{ii})\beta_\ii - \langle C , \WW \rangle + \langle C, v v^* \rangle \notag\\
&+\sum_{(i,j)=l \in L^0} \alpha_i p_l^f(\WW_l) + \alpha_j p_l^t(\WW_l) + \beta_i q_l^f(\WW_l) + \beta_j q_l^t(\WW_l) \notag\\
&+\sum_{l \in L^*} \lambda_l^f p_l^f(\WW_l) + \lambda_l^t p_l^t(\WW_l) + \mu_l^f q_l^f(\WW_l) + \mu_l^t q_l^t(\WW_l) \notag\\
&+ p_\ii^G(\zeta_\ii^{p+}-\zeta_\ii^{p-} - \alpha_\ii) + q_\ii^G(\zeta_\ii^{q+}-\zeta_\ii^{q-} - \beta_\ii)\notag \\
  &+\sum_{\ii \in N}  (V_\ii^{min})^2 \gamma_\ii^- - (V_\ii^{max})^2 \gamma_\ii^+ 
- \zeta_\ii^{p+}P_\ii^{max} + \zeta_\ii^{p-}P_\ii^{min} + \alpha_\ii P_\ii^D 
- \zeta_\ii^{q+}Q_\ii^{max} + \zeta_\ii^{q-}Q_\ii^{min} + \beta_\ii Q_\ii^D \notag \\
  &+ \sum_{(i,j)=l \in L^* } p_{l}^{f}(\alpha_i-\lambda_l^f+\nu_l^{pf}) + p_{l}^{t}(\alpha_j-\lambda_l^t + \nu_l^{pt}) 
                 + q_{l}^{f}(\beta_i-\mu_l^f+\nu_l^{qf}) + q_{l}^{t}(\beta_j-\mu_l^t-\nu_l^{qt})  \notag \\
  & + \sum_{l \in L^* } u_l^{pf0}(x_l-|\nu_l^{pf}|) + u_l^{pt0}(x_l-|\nu_l^{pt}|) + u_l^{qf0}(x_l-|\nu_l^{qf}|) + u_l^{qt0}(x_l - |\nu_l^{qt}|) \notag \\
& + \sum_{l \in L^* } u_l^{pf1}(1-x_l - |\lambda_l^f|) + u_l^{pt1}(1-x_l-|\lambda_l^t|) + u_l^{qf1}(1-x_l-|\mu_l^f|) + u_l^{qt1}(1-x_l-|\mu_l^t|) \notag
\end{align}
\end{subequations}
(The dual feasibility conditions can be read-off readily...)
\end{tiny}
\end{frame}

\begin{frame}{Double-checking dual equivalence: Forming the dual problem}
\begin{tiny}
\begin{subequations}
\begin{align}
& \max_{\substack{\gamma,\zeta \ge 0\\-1\le \alpha,\beta \le 1,\\ \lambda,\mu,x\; \text{free}}} \quad 
 \sum_{\ii \in N}  (V_\ii^{min})^2 \gamma_\ii^- - (V_\ii^{max})^2 \gamma_\ii^+ + \zeta_\ii^{p-}P_\ii^{min} - \zeta_\ii^{p+}P_\ii^{max} +\alpha_\ii P_\ii^D 
+ \zeta_\ii^{q-}Q_\ii^{min} - \zeta_\ii^{q+}Q_\ii^{max} + \beta_\ii Q_\ii^D \notag \\
&s.t.\; (\zeta_\ii^{p+}-\zeta_\ii^{p-} - \alpha_\ii) = 0, \qquad (\zeta_\ii^{q+}-\zeta_\ii^{q-} - \beta_\ii) = 0,\quad \ii \in N. \notag \\
& | \alpha_i -\lambda_\llll^f| \le x_l,\quad| \alpha_j - \lambda_l^t| \le x_l,\quad |\beta_i - \mu_l^f | \le x_l,\quad|\beta_j - \mu_l^t| \le x_l,\quad (i,j)=l \in L^* \notag \\
& |\lambda_l^f| \le 1-x_l,\quad |\lambda_l^t| \le 1-x_l,\quad|\mu_l^f| \le 1-x_l,\quad |\mu_l^t| \le 1-x_l,\quad l \in L^* \notag \\
%& \lambda_l^f = 0,\quad \lambda_l^t = 0,\quad \mu_l^f = 0,\quad \mu_l^t = 0,\quad l \in L^1 \notag \\
& (K-|L^1|-\sum_{l \in L^*} x_l) \ge 0, \qquad\qquad C \succeq 0\notag, \qquad C=H\\
\end{align}
\end{subequations}
where $H(\alpha,\beta,\gamma,\lambda,\mu)$ is the matrix such that for all $\WW$, 
\begin{align*}
\langle H(\alpha,\beta,\gamma,\lambda,\mu), W \rangle = &\sum_{\ii \in N} W_{\ii\ii}(\gamma_\ii^+-\gamma_\ii^-) + \alpha_\ii p_\ii^{sh}(\WW_{ii}) + \beta_\ii q_\ii^{sh}(\WW_{ii}) \\
&+ \sum_{l \in L^*} \lambda_l^f p_l^f(\WW_l) + \lambda_l^t p_l^t(\WW_l) + \mu_l^f q_l^f(\WW_l) + \mu_l^t q_l^t(\WW_l) \notag \\
&+ \sum_{(i,j)=l \in L^0} \alpha_i p_l^f(\WW_l) + \alpha_j p_l^t(\WW_l) + \beta_i q_l^f(\WW_l) + \beta_j q_l^t(\WW_l).
\end{align*}
Note: The dual variables $\lambda,\mu,x$ are indexed by $L^*$ and only appear for such indices.
\end{tiny}
\end{frame}




 

% #References 

\begin{frame}[allowframebreaks]{References} 

\bibliographystyle{apalike} 
%\bibliography{../pscc-scopf}



\end{frame}
      




\end{document}
